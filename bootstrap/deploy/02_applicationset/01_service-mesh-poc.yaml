---
apiVersion: v1
items:
- apiVersion: argoproj.io/v1alpha1
  kind: AppProject
  metadata:
    name: service-mesh
  spec:
    clusterResourceWhitelist:
    - group: '*'
      kind: Namespace
    - group: argoproj.io
      kind: Application
    - group: argoproj.io
      kind: AppProject
    - group: argoproj.io
      kind: ApplicationSet
    - group: '*'
      kind: Secret
    - group: '*'
      kind: PersistentVolumeClaim
    - group: '*'
      kind: Pipeline
    - group: '*'
      kind: ServiceAccount
    destinations:
    - namespace: openshift-gitops
      server: https://kubernetes.default.svc
    namespaceResourceBlacklist:
    - group: ""
      kind: ResourceQuota
    - group: ""
      kind: LimitRange
    - group: ""
      kind: NetworkPolicy
    roles: null
    sourceRepos:
    - '*'
---
apiVersion: argoproj.io/v1alpha1
kind: ApplicationSet
metadata:
  name: service-mesh-poc
  namespace: openshift-gitops
spec:
  generators:
  - git:
      repoURL: https://github.com/ignaciolago/service-mesh-gitops.git
      revision: dev2
      directories:
      - path: resources/kustomization-application-set.yaml
  template:
    metadata:
      name: '{{path.basename}}'
    spec:
      project: service-mesh
      syncPolicy:
        automated:
          prune: true
          selfHeal: true
      source:
        repoURL: https://github.com/ignaciolago/service-mesh-gitops.git
        targetRevision: dev2
        path: '{{path}}'
      destination:
        server: https://kubernetes.default.svc